// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql" // mysql2를 쓰시니 mysql로 설정합니다.
  url      = env("DATABASE_URL")
}

// 1. 사용자 (Owner) - QR 코드를 생성하고 관리하는 주체
model User {
  id        String   @id @default(cuid())
  email     String   @unique
  password  String   // 소셜 로그인 사용 시 optional로 변경 가능
  name      String?
  createdAt DateTime @default(now())
  
  qrCodes   QRCode[] // 1명의 유저는 여러 QR을 가질 수 있음 (자동차, 현관 등)
}

// 2. QR 코드 (QueTem) - 사물/공간과 연결되는 핵심 엔티티
model QRCode {
  id            String   @id @default(cuid()) // QR URL에 들어갈 고유 ID
  name          String   // 예: "내 차", "우리집 현관"
  statusMessage String?  // 예: "잠시 주차 중입니다", "휴가 중"
  isActive      Boolean  @default(true)
  
  ownerId       String
  owner         User     @relation(fields: [ownerId], references: [id])
  
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  @@index([ownerId])
}

// 3. 통화/연결 로그 (선택 사항 - 과금 및 통계를 위해 필요)
model CallLog {
  id        String   @id @default(cuid())
  qrCodeId  String
  startedAt DateTime @default(now())
  duration  Int?     // 통화 시간 (초)
}